<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Safety | Charter Elevator</title>

  <!-- Tailwind CDN loader -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Custom overrides -->
  <link rel="stylesheet" href="/styles/style.css" />
</head>
<body>

  <!-- Header placeholder -->
  <div id="site-header"></div>

  <!-- Wrap all page content below -->
  <div class="site-wrapper">
    <main role="main" class="py-16">
      <div class="container mx-auto px-4">
        <h1 class="text-3xl font-bold mb-6">Safety</h1>
        <p class="mb-4">Placeholder content for the Safety page. Detail safety checks, code compliance, and training protocols.</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <h2 class="text-2xl font-semibold mb-2">Safety Inspections</h2>
            <p>Explain annual and quarterly safety inspections that Charter conducts.</p>
          </div>
          <div>
            <h2 class="text-2xl font-semibold mb-2">Code Compliance</h2>
            <p>Discuss building code requirements, certification, and safety upgrades.</p>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer placeholder -->
    <div id="site-footer"></div>

    <!-- Survey Widget Trigger -->
    <button
      id="open-survey"
      class="fixed bottom-8 right-8 z-50 rounded-full p-4 shadow-lg btn-primary"
      aria-label="Open review survey"
    >Review Us</button>

    <!-- Survey Modal -->
    <div
      id="survey-modal"
      class="hidden fixed inset-0 bg-black/75 z-50 flex items-center justify-center"
      role="dialog"
      aria-modal="true"
      aria-labelledby="survey-title"
    >
      <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-2xl">
        <h3 id="survey-title" class="text-xl font-bold mb-4">How was your experience?</h3>
        <div class="flex justify-between mb-4">
          <button data-rating="1" class="star text-3xl" aria-label="1 star">☆</button>
          <button data-rating="2" class="star text-3xl" aria-label="2 stars">☆</button>
          <button data-rating="3" class="star text-3xl" aria-label="3 stars">☆</button>
          <button data-rating="4" class="star text-3xl" aria-label="4 stars">☆</button>
          <button data-rating="5" class="star text-3xl" aria-label="5 stars">☆</button>
        </div>
        <button
          id="close-survey"
          class="mt-2 text-sm hover:underline"
          aria-label="Cancel survey"
        >Cancel</button>
      </div>
    </div>

    <!-- Internal Feedback Modal -->
    <div
      id="feedback-modal"
      class="hidden fixed inset-0 bg-black/75 z-50 flex items-center justify-center"
      role="dialog"
      aria-modal="true"
      aria-labelledby="feedback-title"
    >
      <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-2XL">
        <h3 id="feedback-title" class="text-xl font-bold mb-4">We’re sorry to hear that.</h3>
        <p class="mb-4">Please tell us what went wrong, and we’ll make it right.</p>
        <form id="feedback-form" class="space-y-4" aria-label="Internal feedback form">
          <input
            type="email"
            placeholder="Your Email (optional)"
            class="w-full p-2 border rounded"
            aria-label="Enter your email (optional)"
          />
          <input
            type="tel"
            placeholder="Your Phone (optional)"
            class="w-full p-2 border rounded"
            aria-label="Enter your phone (optional)"
          />
          <textarea
            placeholder="Your feedback..."
            class="w-full p-2 border rounded"
            required
            aria-label="Describe what went wrong"
          ></textarea>
          <div class="flex justify-between items-center">
            <button
              type="submit"
              class="px-4 py-2 rounded"
              aria-label="Submit feedback"
            >Submit Feedback</button>
            <button
              type="button"
              id="close-feedback"
              class="text-sm hover:underline"
              aria-label="Cancel feedback"
            >Cancel</button>
          </div>
        </form>
      </div>
    </div>

    <!-- ================================ -->
    <!-- Hover-to-Fill Survey/Feedback JS -->
    <!-- ================================ -->
    <script>
      const stars = document.querySelectorAll('#survey-modal .star');
      const openBtn = document.getElementById('open-survey');
      const modal = document.getElementById('survey-modal');
      const closeBtn = document.getElementById('close-survey');
      const feedbackModal = document.getElementById('feedback-modal');
      const closeFeedback = document.getElementById('close-feedback');
      const feedbackForm = document.getElementById('feedback-form');

      // 1) Hover behavior: fill stars up to hovered index
      stars.forEach((star, idx) => {
        star.addEventListener('mouseover', () => {
          stars.forEach((s, i) => {
            if (i <= idx) {
              s.textContent = '★';
              s.classList.add('text-yellow-400');
            } else {
              s.textContent = '☆';
              s.classList.remove('text-yellow-400');
            }
          });
        });
        star.addEventListener('mouseout', () => {
          stars.forEach(s => {
            s.textContent = '☆';
            s.classList.remove('text-yellow-400');
          });
        });
      });

      // 2) Click behavior: record rating, then open feedback or redirect
      stars.forEach(star => {
        star.addEventListener('click', () => {
          const rating = parseInt(star.getAttribute('data-rating'));
          modal.classList.add('hidden');
          if (rating >= 4) {
            alert('Thank you for the review! Please leave a review for us on Google Maps.');
            window.open(
              'https://www.google.com/maps/place/Charter+Elevator',
              '_blank'
            );
          } else {
            feedbackModal.classList.remove('hidden');
          }
        });
      });

      // 3) Open/close survey modal
      openBtn.addEventListener('click', () => modal.classList.remove('hidden'));
      closeBtn.addEventListener('click', () => modal.classList.add('hidden'));

      // 4) Close both modals on ESC
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          modal.classList.add('hidden');
          feedbackModal.classList.add('hidden');
        }
      });

      // 5) Close feedback modal on “Cancel”
      closeFeedback.addEventListener('click', () => feedbackModal.classList.add('hidden'));

      // 6) Submit feedback form
      feedbackForm.addEventListener('submit', function(e) {
        e.preventDefault();
        alert('Thank you for your feedback! We will reach out to you soon.');
        feedbackModal.classList.add('hidden');
      });
    </script>

    <!-- Floating Call-Now Button -->
    <a
      href="tel:877-632-4278"
      class="btn-call"
      aria-label="Call Charter Elevator now"
    >Call Now</a>
  </div> <!-- end .site-wrapper -->

  <!-- Inject header & footer -->
  <script src="/scripts/header-footer.js"></script>

  <!-- Mobile menu toggle & scroll-spy -->
  <script>
    const navToggle = document.getElementById('nav-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    navToggle.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('main section[id]');
    function setActive(id) {
      navLinks.forEach(link => {
        link.classList.remove('text-secondary','font-bold');
        if (link.getAttribute('href') === `${id}.html` || link.getAttribute('href') === `#${id}`) {
          link.classList.add('text-secondary','font-bold');
        }
      });
    }
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        const href = link.getAttribute('href');
        const target = href.includes('.html') ? href.replace('.html','') : href.slice(1);
        setActive(target);
        mobileMenu.classList.add('hidden');
      });
    });
    const observer = new IntersectionObserver(entries => {
      entries.forEach(e => {
        if (e.isIntersecting) setActive(e.target.id);
      });
    }, { rootMargin: '0px 0px -50% 0px' });
    sections.forEach(sec => observer.observe(sec));
  </script>
</body>
</html>
